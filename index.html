<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <title>青色漫地_wait</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <!-- SEO / Open Graph -->
  <meta name="description" content="青色漫地_wait 的个人展示页面。此页面为跳转页示例，页面将在数秒后自动跳转（并提供手动打开与复制链接的备用操作）。" />
  <meta name="robots" content="noindex, nofollow" />
  <meta property="og:title" content="青色漫地_wait" />
  <meta property="og:description" content="青色漫地_wait 的个人展示页面。此页面为跳转页示例，页面将在数秒后自动跳转（并提供手动打开与复制链接的备用操作）。" />
  <meta name="theme-color" content="#2563eb" />

  <style>
    /* =========================
       主题与布局变量（可按需调整）
       ========================= */
    :root{
      --bg-light: #f5f7fb;
      --card-light: #ffffff;
      --text-light: #0f1724;
      --muted-light: #556072;
      --accent-1-light: #2563eb;
      --accent-2-light: #06b6d4;

      --bg-dark: #071028;
      --card-dark: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      --text-dark: #e6eef8;
      --muted-dark: #98a6b6;
      --accent-1-dark: #3b82f6;
      --accent-2-dark: #06b6d4;

      --danger: #ef4444;
      --radius: 12px;
      --shadow: 0 12px 36px rgba(0,0,0,0.16);
      --track-bg-light: rgba(15,23,42,0.06);
      --track-bg-dark: rgba(230,235,245,0.03);

      --max-width: 1100px;
    }

    /* 默认使用深色配色 CSS 变量，脚本会在页面初始化时设置 data-theme */
    :root[data-theme="light"]{
      --bg: var(--bg-light);
      --card: var(--card-light);
      --text: var(--text-light);
      --muted: var(--muted-light);
      --accent-1: var(--accent-1-light);
      --accent-2: var(--accent-2-light);
      --track-bg: var(--track-bg-light);
    }
    :root[data-theme="dark"]{
      --bg: var(--bg-dark);
      --card: var(--card-dark);
      --text: var(--text-dark);
      --muted: var(--muted-dark);
      --accent-1: var(--accent-1-dark);
      --accent-2: var(--accent-2-dark);
      --track-bg: var(--track-bg-dark);
    }

    /* =========================
       基本布局与响应式（关键：min-width:0 + 内部可滚动）
       ========================= */
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;-webkit-font-smoothing:antialiased}
    body{
      min-height:100vh;
      margin:0;
      padding:20px;
      background:var(--bg);
      color:var(--text);
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:auto;
    }

    .container{
      width:100%;
      max-width:var(--max-width);
      border-radius:var(--radius);
      background:var(--card);
      box-shadow:var(--shadow);
      padding:20px;
      display:grid;
      grid-template-columns: 1fr 360px; /* 宽屏左右分半（左主要、右设置） */
      gap:20px;
      align-items:start;
      min-height:220px;
    }

    /* 内部容器用于在窄屏时堆叠并能滚动，min-width:0 是关键 */
    .inner{
      display:flex;
      gap:20px;
      width:100%;
      min-width:0;
      align-items:flex-start;
      overflow:auto;
      max-height: calc(100vh - 80px);
    }

    /* 主区域与侧栏 */
    .main { flex:1 1 auto; min-width:0 }
    .side { width:360px; flex-shrink:0; min-width:0 }

    @media (max-width:880px){
      .container { grid-template-columns: 1fr; padding:16px; }
      .inner { flex-direction:column; }
      .side { width:100%; }
      /* 在手机上按钮更易于点击 */
      .actions { justify-content:stretch; }
      .actions .btn { flex:1 1 auto; }
    }

    /* =========================
       字体、可读性与排版（重要文本加重）
       ========================= */
    h1{margin:0;font-size:1.45rem;line-height:1.15;font-weight:800}
    p{margin:10px 0 12px;color:var(--muted);line-height:1.45;font-size:1rem}
    .muted{color:var(--muted)}
    .lead{font-weight:700;color:var(--text)}

    /* =========================
       进度条（后退：100% -> 0%）
       ========================= */
    .track{height:12px;background:var(--track-bg);border-radius:999px;overflow:hidden}
    .bar{width:100%;height:100%;background:linear-gradient(90deg,var(--accent-1),var(--accent-2));transition:width 80ms linear;border-radius:999px}

    /* =========================
       按钮（统一尺寸、无下划线）
       ========================= */
    .actions{display:flex;gap:12px;margin-top:16px;flex-wrap:wrap}
    .btn{min-width:140px;padding:12px 16px;border-radius:12px;font-weight:800;font-size:1rem;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;gap:8px;border:0;text-decoration:none}
    .btn-primary{background:linear-gradient(90deg,var(--accent-1),var(--accent-2));color:#fff;box-shadow:0 8px 24px rgba(0,0,0,0.12)}
    .btn-neutral{background:transparent;border:1px solid rgba(0,0,0,0.06);color:var(--text)}
    .btn-danger{background:var(--danger);color:#fff}

    /* =========================
       侧栏（上下排列，每项换行显示）
       ========================= */
    .panel{padding:12px;border-radius:10px;background:rgba(255,255,255,0.02);display:flex;flex-direction:column;gap:14px;min-width:0;max-height:calc(100vh - 120px);overflow:auto}
    .block{display:flex;flex-direction:column;gap:8px}
    .label{font-size:0.92rem;color:var(--muted)}
    .desc{font-size:0.86rem;color:var(--muted);line-height:1.35}
    .value{font-size:0.92rem;color:var(--text);word-break:break-word;padding:8px;border-radius:8px;background:transparent}
    .value a{color:var(--accent-1);text-decoration:none;word-break:break-all;display:inline-block;width:100%}
    .controls{display:flex;gap:8px;flex-wrap:wrap}
    .select,.theme-btn{padding:8px 10px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);background:transparent;color:var(--text);font-size:0.92rem}
    .hint{font-size:0.84rem;color:var(--muted)}

    /* 保证长文本与换行良好 */
    .nowrap{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

    /* 可访问性隐藏文本 */
    .sr-only{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap}
  </style>
</head>
<body>
  <!-- 页面主体容器 -->
  <div class="container" id="container" role="region" aria-labelledby="pageTitle">
    <div class="inner">
      <!-- 主区（左） -->
      <main class="main" id="mainArea">
        <h1 id="pageTitle">页面即将跳转</h1>
        <p id="subtitle"><span class="lead">页面会在短时间内自动跳转。</span> 若需要中止，请点击“取消跳转”；若自动跳转被阻止，请使用“立即前往”或复制链接手动打开。</p>

        <div class="track" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="100" aria-label="跳转进度">
          <div class="bar" id="bar"></div>
        </div>

        <!-- 倒计时（两位小数秒），取消或阻断后会隐藏 -->
        <div id="statusText" class="muted" aria-live="polite">3.00s 后跳转</div>

        <!-- 操作按钮：宽屏左右布局，窄屏会拉伸 -->
        <div class="actions" role="group" aria-label="操作">
          <a id="openNow" class="btn btn-primary" href="#" rel="noopener noreferrer">立即前往</a>
          <button id="copyBtn" class="btn btn-neutral" type="button">复制链接</button>
          <button id="cancelBtn" class="btn btn-danger" type="button">取消跳转</button>
        </div>

        <!-- fallback 提示（取消或阻断后显示） -->
        <div id="fallbackNote" class="muted" aria-live="polite" style="margin-top:12px"></div>
        <div id="ariaStatus" class="sr-only" aria-live="polite"></div>
      </main>

      <!-- 侧栏（右）-- 在宽屏显示，窄屏堆叠到下方 -->
      <aside class="side">
        <section class="panel" aria-label="设置">
          <!-- 目标地址（在宽屏位于侧栏） -->
          <div class="block">
            <div class="label" id="labelTarget">目标地址</div>
            <div class="desc" id="descTarget">将作为跳转目标和复制链接内容</div>
            <div class="value" id="targetValue"><a id="targetLink" href="#" target="_blank" rel="noopener noreferrer">https://qsmd-wait.netlify.app/</a></div>
          </div>

          <!-- 语言 -->
          <div class="block">
            <div class="label" id="labelLang">语言</div>
            <div class="desc" id="descLang">自动检测浏览器语言，可手动切换并保存</div>
            <div class="controls">
              <select id="langSelect" class="select" aria-label="选择语言">
                <option value="zh-CN">中文（简体） - zh-CN</option>
                <option value="zh-TW">中文（繁體） - zh-TW</option>
                <option value="en-US">English - en-US</option>
                <option value="es-ES">Español - es-ES</option>
                <option value="fr-FR">Français - fr-FR</option>
              </select>
            </div>
          </div>

          <!-- 主题 -->
          <div class="block">
            <div class="label" id="labelTheme">主题</div>
            <div class="desc" id="descTheme">默认为“自动”（若无缓存与系统偏好，则显示浅色），可手动切换</div>
            <div class="controls">
              <button id="themeToggle" class="theme-btn" aria-pressed="false">自动</button>
            </div>
          </div>

          <div class="hint" id="panelHint">保存的语言与主题偏好将保存在本地。</div>
        </section>
      </aside>
    </div>
  </div>

  <script>
    /* =========================
       可修改常量区（发布前请确认 TARGET）
       ========================= */
    const TARGET = "https://qsmd-wait.netlify.app/"; // 跳转目标
    const DELAY_MS = 3000; // 自动跳转等待时长（毫秒）
    const NAV_PROBE_MS = 700; // 触发跳转后检测是否仍在页面（ms）

    /* =========================
       完整国际化文本（所有可见文本都在这里维护）
       新增语言请在此对象中补全所有字段
       ========================= */
    const I18N = {
      "zh-CN": {
        title: "页面即将跳转",
        subtitle: "页面会在短时间内自动跳转。若需要中止，请点击“取消跳转”。若自动跳转被阻止，请使用“立即前往”或复制链接手动打开。",
        openNow: "立即前往",
        copy: "复制链接",
        copied: "已复制",
        cancel: "取消跳转",
        fallback: "检测到自动跳转未生效，已停止并提供手动选项。",
        countdownFmt: t => t.toFixed(2) + "s 后跳转",
        targetLabel: "目标地址",
        targetDesc: "将作为跳转目标和复制链接内容",
        langLabel: "语言",
        langDesc: "自动检测浏览器语言，可手动切换并保存",
        themeLabel: "主题",
        themeDesc: "默认为“自动”（若无缓存与系统偏好，则显示浅色），可手动切换",
        panelHint: "保存的语言与主题偏好将保存在本地。",
        themeAuto: "自动",
        themeLight: "浅色",
        themeDark: "深色"
      },
      "zh-TW": {
        title: "頁面即將跳轉",
        subtitle: "頁面會在短時間內自動跳轉。若需中止，請點選「取消跳轉」。若自動跳轉被阻擋，請使用「立即前往」或複製連結手動開啟。",
        openNow: "立即前往",
        copy: "複製連結",
        copied: "已複製",
        cancel: "取消跳轉",
        fallback: "偵測到自動跳轉未生效，已停止並提供手動選項。",
        countdownFmt: t => t.toFixed(2) + "s 後跳轉",
        targetLabel: "目標位址",
        targetDesc: "將作為跳轉目標與複製連結內容",
        langLabel: "語言",
        langDesc: "自動偵測瀏覽器語言，可手動切換並儲存",
        themeLabel: "主題",
        themeDesc: "預設為「自動」（若無快取與系統偏好，顯示淺色），可手動切換",
        panelHint: "儲存的語言與主題偏好將保存在本機。",
        themeAuto: "自動",
        themeLight: "淺色",
        themeDark: "深色"
      },
      "en-US": {
        title: "Redirecting shortly",
        subtitle: "The page will automatically redirect shortly. To stop it, click Cancel. If auto-redirect is blocked, use Open now or copy the link to open manually.",
        openNow: "Open now",
        copy: "Copy link",
        copied: "Copied",
        cancel: "Cancel redirect",
        fallback: "Auto-redirect appears blocked. Manual options are available.",
        countdownFmt: t => t.toFixed(2) + "s until redirect",
        targetLabel: "Target",
        targetDesc: "Used as the redirect destination and copy link content",
        langLabel: "Language",
        langDesc: "Auto-detect browser language, can switch and save",
        themeLabel: "Theme",
        themeDesc: "Default is Auto (if no cache and no system preference, shows Light); can switch manually",
        panelHint: "Saved language and theme preferences are stored locally.",
        themeAuto: "Auto",
        themeLight: "Light",
        themeDark: "Dark"
      },
      "es-ES": {
        title: "Redirigiendo en breve",
        subtitle: "La página redirigirá automáticamente en breve. Para detenerlo, haga clic en Cancelar. Si se bloquea, use Abrir ahora o copie el enlace.",
        openNow: "Abrir ahora",
        copy: "Copiar enlace",
        copied: "Copiado",
        cancel: "Cancelar redirección",
        fallback: "Parece que la redirección automática fue bloqueada. Opciones manuales disponibles.",
        countdownFmt: t => t.toFixed(2) + "s hasta la redirección",
        targetLabel: "Destino",
        targetDesc: "Se usará como destino de redirección y contenido de copia",
        langLabel: "Idioma",
        langDesc: "Detecta el idioma del navegador; puede cambiar y guardar",
        themeLabel: "Tema",
        themeDesc: "Predeterminado Auto (si no hay caché ni preferencia de sistema, muestra Claro); puede cambiarse manualmente",
        panelHint: "Las preferencias se guardan localmente.",
        themeAuto: "Auto",
        themeLight: "Claro",
        themeDark: "Oscuro"
      },
      "fr-FR": {
        title: "Redirection imminente",
        subtitle: "La page redirigera automatiquement sous peu. Pour l'arrêter, cliquez sur Annuler. Si bloqué, utilisez Ouvrir maintenant ou copiez le lien.",
        openNow: "Ouvrir maintenant",
        copy: "Copier le lien",
        copied: "Copié",
        cancel: "Annuler la redirection",
        fallback: "La redirection automatique semble bloquée. Options manuelles disponibles.",
        countdownFmt: t => t.toFixed(2) + "s avant la redirection",
        targetLabel: "Cible",
        targetDesc: "Utilisé comme destination de redirection et contenu du lien",
        langLabel: "Langue",
        langDesc: "Détecte la langue du navigateur; peut être modifiée et sauvegardée",
        themeLabel: "Thème",
        themeDesc: "Par défaut Auto (si pas de cache et pas de préférence système, affiche Clair); modifiable manuellement",
        panelHint: "Les préférences sont stockées localement.",
        themeAuto: "Auto",
        themeLight: "Clair",
        themeDark: "Sombre"
      }
    };

    /* =========================
       DOM 缓存引用（便于维护）
       ========================= */
    const DOM = {
      bar: document.getElementById('bar'),
      statusText: document.getElementById('statusText'),
      fallbackNote: document.getElementById('fallbackNote'),
      ariaStatus: document.getElementById('ariaStatus'),

      openNow: document.getElementById('openNow'),
      copyBtn: document.getElementById('copyBtn'),
      cancelBtn: document.getElementById('cancelBtn'),

      langSelect: document.getElementById('langSelect'),
      themeToggle: document.getElementById('themeToggle'),

      targetLink: document.getElementById('targetLink'),

      pageTitle: document.getElementById('pageTitle'),
      subtitle: document.getElementById('subtitle'),
      panelHint: document.getElementById('panelHint')
    };

    /* =========================
       首次检测与默认策略（顺序与说明）
       - 语言检测顺序：localStorage(cm_lang) -> navigator.language -> 'en-US'
       - 主题检测顺序：localStorage(cm_theme) -> 'auto' 默认 -> 若 auto 则使用 prefers-color-scheme 决定实际显示
       说明：若本地无缓存，默认 currentTheme = 'auto'（页面呈现会依据系统偏好，但若系统未提供偏好，将展示浅色）
       ========================= */
    function detectLang(){
      const stored = localStorage.getItem('cm_lang');
      if(stored && I18N[stored]) return stored;
      const nav = navigator.language || navigator.userLanguage || 'en-US';
      if(nav.startsWith('zh-TW') || nav.startsWith('zh-HK')) return 'zh-TW';
      if(nav.startsWith('zh')) return 'zh-CN';
      if(nav.startsWith('es')) return 'es-ES';
      if(nav.startsWith('fr')) return 'fr-FR';
      if(nav.startsWith('en')) return 'en-US';
      return 'en-US';
    }

    function detectTheme(){
      const stored = localStorage.getItem('cm_theme'); // 'auto'|'light'|'dark'
      if(stored) return stored;
      // 默认返回 'auto'（发布要求：默认主题为自动）
      return 'auto';
    }

    let currentLang = detectLang();
    let currentTheme = detectTheme();
    let countdownActive = true; // 倒计时是否仍在进行（取消或阻断后置 false）

    /* =========================
       应用文本与主题（不会重启倒计时）
       ========================= */
    function applyI18n(lang){
      const t = I18N[lang] || I18N['en-US'];
      DOM.pageTitle.textContent = t.title;
      document.title = "青色漫地_wait"; // 固定浏览器标题为发布要求
      DOM.subtitle.textContent = t.subtitle;
      DOM.openNow.textContent = t.openNow;
      DOM.copyBtn.textContent = t.copy;
      DOM.cancelBtn.textContent = t.cancel;
      DOM.panelHint.textContent = t.panelHint;
      DOM.targetLink.textContent = TARGET;
      DOM.targetLink.href = TARGET;
      if(countdownActive){
        DOM.statusText.textContent = t.countdownFmt(DELAY_MS / 1000);
      } else {
        DOM.statusText.textContent = '';
      }
      DOM.ariaStatus.textContent = t.title;
    }

    function applyTheme(theme){
      /* 若 theme === 'auto'：使用系统 prefers-color-scheme 决定实际呈现
         若系统不支持 prefers-color-scheme，按发布要求使用浅色显示 */
      if(theme === 'auto'){
        const mq = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)');
        const prefersDark = mq ? mq.matches : false;
        document.documentElement.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
        DOM.themeToggle.textContent = (I18N[currentLang] && I18N[currentLang].themeAuto) || '自动';
        DOM.themeToggle.setAttribute('aria-pressed', prefersDark ? 'true' : 'false');
      } else if(theme === 'dark'){
        document.documentElement.setAttribute('data-theme', 'dark');
        DOM.themeToggle.textContent = (I18N[currentLang] && I18N[currentLang].themeDark) || '深色';
        DOM.themeToggle.setAttribute('aria-pressed', 'true');
      } else {
        document.documentElement.setAttribute('data-theme', 'light');
        DOM.themeToggle.textContent = (I18N[currentLang] && I18N[currentLang].themeLight) || '浅色';
        DOM.themeToggle.setAttribute('aria-pressed', 'false');
      }
    }

    /* =========================
       控件初始化与事件（语言切换不重启倒计时）
       ========================= */
    function initControls(){
      // 初始化语言下拉
      DOM.langSelect.value = currentLang;
      DOM.langSelect.addEventListener('change', (e) => {
        currentLang = e.target.value;
        localStorage.setItem('cm_lang', currentLang);
        applyI18n(currentLang);
        applyTheme(currentTheme); // 更新主题按钮文本
      });

      // 主题按钮循环：auto -> light -> dark -> auto
      DOM.themeToggle.addEventListener('click', () => {
        if(currentTheme === 'auto') currentTheme = 'light';
        else if(currentTheme === 'light') currentTheme = 'dark';
        else currentTheme = 'auto';
        localStorage.setItem('cm_theme', currentTheme);
        applyTheme(currentTheme);
      });

      // 按钮行为
      DOM.openNow.href = TARGET;
      DOM.openNow.addEventListener('click', () => cancelAuto(true)); // 点击手动打开时取消自动跳转

      DOM.copyBtn.addEventListener('click', async () => {
        try {
          await navigator.clipboard.writeText(TARGET);
          DOM.copyBtn.textContent = (I18N[currentLang] && I18N[currentLang].copied) || '已复制';
          setTimeout(()=> DOM.copyBtn.textContent = (I18N[currentLang] && I18N[currentLang].copy) || '复制链接', 1200);
        } catch (e) {
          // 兼容复制
          const ta = document.createElement('textarea'); ta.value = TARGET; document.body.appendChild(ta); ta.select();
          try{ document.execCommand('copy'); }catch(_){} document.body.removeChild(ta);
        }
        cancelAuto(true);
      });

      DOM.cancelBtn.addEventListener('click', () => cancelAuto(true));
    }

    /* 首次渲染 */
    applyI18n(currentLang);
    applyTheme(currentTheme);
    initControls();

    /* =========================
       进度条与自动跳转逻辑（后退进度）
       说明：倒计时仅在首次页面加载时运行并受 countdownActive 控制。
       一旦被取消或被阻断，countdownActive = false，语言切换不会重新启用倒计时。
       ========================= */
    let startTs = null;
    let raf = null;
    let cancelled = false;
    let redirected = false;

    function tick(ts){
      if(!startTs) startTs = ts;
      const elapsed = ts - startTs;
      const remaining = Math.max(0, DELAY_MS - elapsed);
      const pct = Math.max(0, Math.min(100, (remaining / DELAY_MS) * 100)); // 100 -> 0
      DOM.bar.style.width = pct + '%';

      if(countdownActive){
        DOM.statusText.textContent = (I18N[currentLang] && I18N[currentLang].countdownFmt(remaining/1000)) || (remaining/1000).toFixed(2) + 's';
        DOM.ariaStatus.textContent = DOM.statusText.textContent;
      } else {
        DOM.statusText.textContent = '';
      }

      if(elapsed < DELAY_MS && !cancelled){
        raf = requestAnimationFrame(tick);
      } else if(!cancelled && !redirected){
        redirected = true;
        try {
          // 尝试跳转并在短时间后检测是否仍在本页
          window.location.replace(TARGET);
          setTimeout(() => {
            if(!document.hidden){
              handleBlocked();
            }
          }, NAV_PROBE_MS);
        } catch (e){
          handleBlocked();
        }
      }
    }

    function handleBlocked(){
      cancelled = true;
      countdownActive = false;
      if(raf) cancelAnimationFrame(raf);
      DOM.bar.style.width = '100%'; // 立即回满
      DOM.fallbackNote.textContent = (I18N[currentLang] && I18N[currentLang].fallback) || '跳转被阻止';
      DOM.statusText.textContent = '';
      DOM.ariaStatus.textContent = DOM.fallbackNote.textContent;
      DOM.openNow.focus();
    }

    function cancelAuto(userInitiated){
      cancelled = true;
      countdownActive = false;
      if(raf) cancelAnimationFrame(raf);
      DOM.bar.style.width = '100%';
      if(userInitiated){
        DOM.fallbackNote.textContent = (I18N[currentLang] && I18N[currentLang].cancel) || '已取消';
        DOM.statusText.textContent = '';
        DOM.ariaStatus.textContent = DOM.fallbackNote.textContent;
      } else {
        DOM.fallbackNote.textContent = (I18N[currentLang] && I18N[currentLang].fallback) || '跳转被阻止';
        DOM.statusText.textContent = '';
        DOM.ariaStatus.textContent = DOM.fallbackNote.textContent;
      }
    }

    document.addEventListener('visibilitychange', () => {
      if(document.hidden && !redirected){
        redirected = true;
        if(raf) cancelAnimationFrame(raf);
      }
    });

    raf = requestAnimationFrame(tick);

    /* =========================
       系统主题变化监听：
       - 仅在用户选择 auto 或未设置本地主题时响应系统切换
       ========================= */
    if(window.matchMedia){
      const mq = window.matchMedia('(prefers-color-scheme: dark)');
      mq.addEventListener && mq.addEventListener('change', () => {
        const stored = localStorage.getItem('cm_theme');
        if(!stored || stored === 'auto'){
          applyTheme('auto');
        }
      });
    }

    /* =========================
       首次保存检测到的偏好（便于用户后续修改）
       - 若本地未设置 language/theme，则写入检测结果（language）或 'auto'（theme）
       ========================= */
    (function persistDefaults(){
      if(!localStorage.getItem('cm_lang')) localStorage.setItem('cm_lang', currentLang);
      if(!localStorage.getItem('cm_theme')) localStorage.setItem('cm_theme', currentTheme);
    })();

    /* 开发/运维方便：控制台输出当前配置 */
    console.info('[publish-redirect] config', { TARGET, DELAY_MS, lang: currentLang, theme: currentTheme, countdownActive });
  </script>
</body>
</html>